#include <stdio.h>
#include "linus.h"


/*
"""
Uses coil statistics from coil_noH_noE to make a probability mesostates file
that is residue specific for simulations using a smart coil moveset.

Needs a LINUS pdb file as input just to get the sequence.

Then do a probability mesostate simulations with the following:

    use_pms_sampling=1,
    pmsfile = os.path.abspath('pmeso_weights')
        os.link('pmeso_weights', curdir+os.sep+'pmeso_weights')

"""

USAGE = """
python $LINUS24/mk_smrt_pmeso.py [filename].pdb
Output is file pmeso_weights

"""


*/


void smrt_pmeso(LinusProtein *p, char *filename)
{
    FILE *file = fopen(filename,"w+");
    
    int i,j,k;
    
    for(i=0;i<p->num_res-1;i++)
    {
        int pmeso_grid_i[144];
        for(j=0;j<144;j++)
        {
            pmeso_grid_i[j] = 0;
        }
        
        if(!strcmp(p->res_names[i],"GLY"))
        {
        
        pmeso_grid_i[0] = 1905;
            pmeso_grid_i[1] = 242;
            pmeso_grid_i[2] = 24;
            pmeso_grid_i[3] = 15;
            pmeso_grid_i[4] = 17;
            pmeso_grid_i[5] = 19;
            pmeso_grid_i[6] = 15;
            pmeso_grid_i[7] = 20;
            pmeso_grid_i[8] = 17;
            pmeso_grid_i[9] = 25;
            pmeso_grid_i[10] = 170;
            pmeso_grid_i[11] = 1800;
            pmeso_grid_i[12] = 928;
            pmeso_grid_i[13] = 173;
            pmeso_grid_i[14] = 50;
            pmeso_grid_i[15] = 14;
            pmeso_grid_i[16] = 10;
            pmeso_grid_i[17] = 26;
            pmeso_grid_i[18] = 80;
            pmeso_grid_i[19] = 57;
            pmeso_grid_i[20] = 40;
            pmeso_grid_i[21] = 8;
            pmeso_grid_i[22] = 92;
            pmeso_grid_i[23] = 500;
            pmeso_grid_i[24] = 907;
            pmeso_grid_i[25] = 357;
            pmeso_grid_i[26] = 127;
            pmeso_grid_i[27] = 54;
            pmeso_grid_i[28] = 47;
            pmeso_grid_i[29] = 223;
            pmeso_grid_i[30] = 542;
            pmeso_grid_i[31] = 133;
            pmeso_grid_i[32] = 31;
            pmeso_grid_i[33] = 27;
            pmeso_grid_i[34] = 113;
            pmeso_grid_i[35] = 317;
            pmeso_grid_i[36] = 2228;
            pmeso_grid_i[37] = 367;
            pmeso_grid_i[38] = 106;
            pmeso_grid_i[39] = 127;
            pmeso_grid_i[40] = 205;
            pmeso_grid_i[41] = 1466;
            pmeso_grid_i[42] = 1515;
            pmeso_grid_i[43] = 221;
            pmeso_grid_i[44] = 145;
            pmeso_grid_i[45] = 70;
            pmeso_grid_i[46] = 262;
            pmeso_grid_i[47] = 1262;
            pmeso_grid_i[48] = 265;
            pmeso_grid_i[49] = 19;
            pmeso_grid_i[50] = 16;
            pmeso_grid_i[51] = 61;
            pmeso_grid_i[52] = 1127;
            pmeso_grid_i[53] = 1851;
            pmeso_grid_i[54] = 87;
            pmeso_grid_i[55] = 29;
            pmeso_grid_i[56] = 32;
            pmeso_grid_i[57] = 55;
            pmeso_grid_i[58] = 1410;
            pmeso_grid_i[59] = 1721;
            pmeso_grid_i[60] = 4;
            pmeso_grid_i[62] = 5;
            pmeso_grid_i[63] = 17;
            pmeso_grid_i[64] = 57;
            pmeso_grid_i[65] = 7;
            pmeso_grid_i[67] = 4;
            pmeso_grid_i[68] = 4;
            pmeso_grid_i[69] = 10;
            pmeso_grid_i[70] = 23;
            pmeso_grid_i[71] = 11;
            pmeso_grid_i[84] = 11;
            pmeso_grid_i[85] = 77;
            pmeso_grid_i[86] = 29;
            pmeso_grid_i[87] = 2;
            pmeso_grid_i[88] = 3;
            pmeso_grid_i[90] = 7;
            pmeso_grid_i[91] = 39;
            pmeso_grid_i[92] = 22;
            pmeso_grid_i[94] = 2;
            pmeso_grid_i[95] = 4;
            pmeso_grid_i[96] = 1236;
            pmeso_grid_i[97] = 2499;
            pmeso_grid_i[98] = 317;
            pmeso_grid_i[99] = 19;
            pmeso_grid_i[100] = 28;
            pmeso_grid_i[101] = 270;
            pmeso_grid_i[102] = 5067;
            pmeso_grid_i[103] = 2554;
            pmeso_grid_i[104] = 70;
            pmeso_grid_i[105] = 12;
            pmeso_grid_i[106] = 19;
            pmeso_grid_i[107] = 154;
            pmeso_grid_i[108] = 2132;
            pmeso_grid_i[109] = 525;
            pmeso_grid_i[110] = 131;
            pmeso_grid_i[111] = 137;
            pmeso_grid_i[112] = 360;
            pmeso_grid_i[113] = 8770;
            pmeso_grid_i[114] = 10498;
            pmeso_grid_i[115] = 572;
            pmeso_grid_i[116] = 77;
            pmeso_grid_i[117] = 111;
            pmeso_grid_i[118] = 473;
            pmeso_grid_i[119] = 2106;
            pmeso_grid_i[120] = 926;
            pmeso_grid_i[121] = 203;
            pmeso_grid_i[122] = 45;
            pmeso_grid_i[123] = 61;
            pmeso_grid_i[124] = 231;
            pmeso_grid_i[125] = 1549;
            pmeso_grid_i[126] = 805;
            pmeso_grid_i[127] = 68;
            pmeso_grid_i[128] = 29;
            pmeso_grid_i[129] = 130;
            pmeso_grid_i[130] = 383;
            pmeso_grid_i[131] = 1052;
            pmeso_grid_i[132] = 1361;
            pmeso_grid_i[133] = 272;
            pmeso_grid_i[134] = 24;
            pmeso_grid_i[135] = 23;
            pmeso_grid_i[136] = 83;
            pmeso_grid_i[137] = 113;
            pmeso_grid_i[138] = 29;
            pmeso_grid_i[139] = 14;
            pmeso_grid_i[140] = 9;
            pmeso_grid_i[141] = 37;
            pmeso_grid_i[142] = 169;
            pmeso_grid_i[143] = 903;
        
        }
        
         else if(!strcmp(p->res_names[i],"PRO"))
        {
            pmeso_grid_i[24] = 2;
            pmeso_grid_i[26] = 3;
            pmeso_grid_i[28] = 2;
            pmeso_grid_i[29] = 5;
            pmeso_grid_i[30] = 5;
            pmeso_grid_i[31] = 2;
            pmeso_grid_i[33] = 2;
            pmeso_grid_i[34] = 2;
            pmeso_grid_i[35] = 5;
            pmeso_grid_i[36] = 157;
            pmeso_grid_i[37] = 10;
            pmeso_grid_i[38] = 4;
            pmeso_grid_i[39] = 5;
            pmeso_grid_i[40] = 38;
            pmeso_grid_i[41] = 1139;
            pmeso_grid_i[42] = 484;
            pmeso_grid_i[43] = 307;
            pmeso_grid_i[44] = 536;
            pmeso_grid_i[45] = 98;
            pmeso_grid_i[46] = 404;
            pmeso_grid_i[47] = 1331;
            pmeso_grid_i[48] = 62;
            pmeso_grid_i[49] = 7;
            pmeso_grid_i[50] = 9;
            pmeso_grid_i[51] = 56;
            pmeso_grid_i[52] = 4014;
            pmeso_grid_i[53] = 6899;
            pmeso_grid_i[54] = 114;
            pmeso_grid_i[55] = 117;
            pmeso_grid_i[56] = 169;
            pmeso_grid_i[57] = 481;
            pmeso_grid_i[58] = 15624;
            pmeso_grid_i[59] = 7712;
            pmeso_grid_i[60] = 3;
            pmeso_grid_i[61] = 2;
            pmeso_grid_i[62] = 9;
            pmeso_grid_i[63] = 45;
            pmeso_grid_i[64] = 314;
            pmeso_grid_i[65] = 36;
            pmeso_grid_i[66] = 2;
            pmeso_grid_i[68] = 6;
            pmeso_grid_i[69] = 58;
            pmeso_grid_i[70] = 241;
            pmeso_grid_i[71] = 9;
            pmeso_grid_i[84] = 2;
            pmeso_grid_i[95] = 2;
            pmeso_grid_i[111] = 5;
            pmeso_grid_i[116] = 2;
            pmeso_grid_i[117] = 2;
            pmeso_grid_i[118] = 3;
}
        else if(!strcmp(p->res_names[i],"ALA"))
{
            pmeso_grid_i[0] = 90;
            pmeso_grid_i[1] = 3;
            pmeso_grid_i[2] = 4;
            pmeso_grid_i[3] = 3;
            pmeso_grid_i[4] = 14;
            pmeso_grid_i[5] = 5;
            pmeso_grid_i[7] = 4;
            pmeso_grid_i[8] = 9;
            pmeso_grid_i[9] = 11;
            pmeso_grid_i[10] = 163;
            pmeso_grid_i[11] = 860;
            pmeso_grid_i[12] = 138;
            pmeso_grid_i[13] = 30;
            pmeso_grid_i[14] = 26;
            pmeso_grid_i[15] = 14;
            pmeso_grid_i[16] = 21;
            pmeso_grid_i[17] = 30;
            pmeso_grid_i[18] = 87;
            pmeso_grid_i[19] = 173;
            pmeso_grid_i[20] = 262;
            pmeso_grid_i[21] = 119;
            pmeso_grid_i[22] = 643;
            pmeso_grid_i[23] = 1148;
            pmeso_grid_i[24] = 92;
            pmeso_grid_i[25] = 31;
            pmeso_grid_i[26] = 38;
            pmeso_grid_i[27] = 35;
            pmeso_grid_i[28] = 125;
            pmeso_grid_i[29] = 364;
            pmeso_grid_i[30] = 636;
            pmeso_grid_i[31] = 230;
            pmeso_grid_i[32] = 289;
            pmeso_grid_i[33] = 185;
            pmeso_grid_i[34] = 561;
            pmeso_grid_i[35] = 490;
            pmeso_grid_i[36] = 124;
            pmeso_grid_i[37] = 29;
            pmeso_grid_i[38] = 16;
            pmeso_grid_i[39] = 64;
            pmeso_grid_i[40] = 664;
            pmeso_grid_i[41] = 2337;
            pmeso_grid_i[42] = 1525;
            pmeso_grid_i[43] = 216;
            pmeso_grid_i[44] = 594;
            pmeso_grid_i[45] = 351;
            pmeso_grid_i[46] = 1332;
            pmeso_grid_i[47] = 1259;
            pmeso_grid_i[48] = 21;
            pmeso_grid_i[49] = 5;
            pmeso_grid_i[50] = 5;
            pmeso_grid_i[51] = 41;
            pmeso_grid_i[52] = 3982;
            pmeso_grid_i[53] = 4049;
            pmeso_grid_i[54] = 92;
            pmeso_grid_i[55] = 15;
            pmeso_grid_i[56] = 55;
            pmeso_grid_i[57] = 266;
            pmeso_grid_i[58] = 6756;
            pmeso_grid_i[59] = 2541;
            pmeso_grid_i[61] = 2;
            pmeso_grid_i[62] = 7;
            pmeso_grid_i[63] = 28;
            pmeso_grid_i[64] = 126;
            pmeso_grid_i[65] = 9;
            pmeso_grid_i[68] = 2;
            pmeso_grid_i[69] = 24;
            pmeso_grid_i[70] = 90;
            pmeso_grid_i[71] = 7;
            pmeso_grid_i[85] = 17;
            pmeso_grid_i[86] = 7;
            pmeso_grid_i[87] = 4;
            pmeso_grid_i[91] = 75;
            pmeso_grid_i[92] = 37;
            pmeso_grid_i[93] = 5;
            pmeso_grid_i[96] = 28;
            pmeso_grid_i[97] = 89;
            pmeso_grid_i[98] = 19;
            pmeso_grid_i[99] = 4;
            pmeso_grid_i[100] = 38;
            pmeso_grid_i[101] = 25;
            pmeso_grid_i[102] = 327;
            pmeso_grid_i[103] = 668;
            pmeso_grid_i[104] = 52;
            pmeso_grid_i[105] = 11;
            pmeso_grid_i[106] = 4;
            pmeso_grid_i[107] = 11;
            pmeso_grid_i[108] = 8;
            pmeso_grid_i[109] = 2;
            pmeso_grid_i[110] = 8;
            pmeso_grid_i[111] = 13;
            pmeso_grid_i[112] = 12;
            pmeso_grid_i[113] = 19;
            pmeso_grid_i[114] = 33;
            pmeso_grid_i[115] = 3;
            pmeso_grid_i[116] = 4;
            pmeso_grid_i[117] = 3;
            pmeso_grid_i[118] = 11;
            pmeso_grid_i[119] = 5;
            pmeso_grid_i[124] = 2;
            pmeso_grid_i[125] = 2;
            pmeso_grid_i[131] = 3;
            pmeso_grid_i[132] = 3;
            pmeso_grid_i[136] = 2;
            pmeso_grid_i[137] = 2;
            pmeso_grid_i[138] = 2;
            pmeso_grid_i[140] = 3;
}
        else if(!strcmp(p->res_names[i],"ARG"))
{
            pmeso_grid_i[0] = 13;
            pmeso_grid_i[3] = 3;
            pmeso_grid_i[4] = 4;
            pmeso_grid_i[6] = 3;
            pmeso_grid_i[7] = 2;
            pmeso_grid_i[8] = 6;
            pmeso_grid_i[9] = 10;
            pmeso_grid_i[10] = 76;
            pmeso_grid_i[11] = 273;
            pmeso_grid_i[12] = 71;
            pmeso_grid_i[13] = 5;
            pmeso_grid_i[14] = 3;
            pmeso_grid_i[15] = 12;
            pmeso_grid_i[16] = 33;
            pmeso_grid_i[17] = 44;
            pmeso_grid_i[18] = 77;
            pmeso_grid_i[19] = 68;
            pmeso_grid_i[20] = 174;
            pmeso_grid_i[21] = 123;
            pmeso_grid_i[22] = 698;
            pmeso_grid_i[23] = 936;
            pmeso_grid_i[24] = 91;
            pmeso_grid_i[25] = 18;
            pmeso_grid_i[26] = 25;
            pmeso_grid_i[27] = 46;
            pmeso_grid_i[28] = 287;
            pmeso_grid_i[29] = 689;
            pmeso_grid_i[30] = 1008;
            pmeso_grid_i[31] = 251;
            pmeso_grid_i[32] = 294;
            pmeso_grid_i[33] = 341;
            pmeso_grid_i[34] = 975;
            pmeso_grid_i[35] = 795;
            pmeso_grid_i[36] = 69;
            pmeso_grid_i[37] = 6;
            pmeso_grid_i[38] = 8;
            pmeso_grid_i[39] = 58;
            pmeso_grid_i[40] = 558;
            pmeso_grid_i[41] = 1757;
            pmeso_grid_i[42] = 1206;
            pmeso_grid_i[43] = 100;
            pmeso_grid_i[44] = 344;
            pmeso_grid_i[45] = 404;
            pmeso_grid_i[46] = 1225;
            pmeso_grid_i[47] = 749;
            pmeso_grid_i[48] = 15;
            pmeso_grid_i[49] = 3;
            pmeso_grid_i[50] = 4;
            pmeso_grid_i[51] = 45;
            pmeso_grid_i[52] = 1898;
            pmeso_grid_i[53] = 1926;
            pmeso_grid_i[54] = 59;
            pmeso_grid_i[55] = 6;
            pmeso_grid_i[56] = 19;
            pmeso_grid_i[57] = 172;
            pmeso_grid_i[58] = 3044;
            pmeso_grid_i[59] = 852;
            pmeso_grid_i[62] = 2;
            pmeso_grid_i[63] = 12;
            pmeso_grid_i[64] = 71;
            pmeso_grid_i[65] = 5;
            pmeso_grid_i[69] = 17;
            pmeso_grid_i[70] = 44;
            pmeso_grid_i[71] = 5;
            pmeso_grid_i[84] = 2;
            pmeso_grid_i[85] = 8;
            pmeso_grid_i[86] = 3;
            pmeso_grid_i[87] = 3;
            pmeso_grid_i[91] = 62;
            pmeso_grid_i[92] = 22;
            pmeso_grid_i[95] = 2;
            pmeso_grid_i[96] = 10;
            pmeso_grid_i[97] = 44;
            pmeso_grid_i[98] = 19;
            pmeso_grid_i[99] = 10;
            pmeso_grid_i[100] = 18;
            pmeso_grid_i[101] = 29;
            pmeso_grid_i[102] = 379;
            pmeso_grid_i[103] = 823;
            pmeso_grid_i[104] = 77;
            pmeso_grid_i[105] = 7;
            pmeso_grid_i[106] = 5;
            pmeso_grid_i[107] = 8;
            pmeso_grid_i[111] = 4;
            pmeso_grid_i[112] = 4;
            pmeso_grid_i[113] = 47;
            pmeso_grid_i[114] = 37;
            pmeso_grid_i[115] = 5;
            pmeso_grid_i[116] = 6;
            pmeso_grid_i[117] = 8;
            pmeso_grid_i[118] = 9;
            pmeso_grid_i[119] = 3;
            pmeso_grid_i[125] = 2;
            pmeso_grid_i[140] = 2;
            pmeso_grid_i[143] = 3;
}
        else if(!strcmp(p->res_names[i],"ASN"))
{
            pmeso_grid_i[0] = 65;
            pmeso_grid_i[2] = 2;
            pmeso_grid_i[3] = 5;
            pmeso_grid_i[4] = 8;
            pmeso_grid_i[5] = 6;
            pmeso_grid_i[6] = 10;
            pmeso_grid_i[7] = 7;
            pmeso_grid_i[8] = 31;
            pmeso_grid_i[9] = 35;
            pmeso_grid_i[10] = 50;
            pmeso_grid_i[11] = 211;
            pmeso_grid_i[12] = 446;
            pmeso_grid_i[13] = 9;
            pmeso_grid_i[14] = 10;
            pmeso_grid_i[15] = 17;
            pmeso_grid_i[16] = 14;
            pmeso_grid_i[17] = 62;
            pmeso_grid_i[18] = 233;
            pmeso_grid_i[19] = 234;
            pmeso_grid_i[20] = 508;
            pmeso_grid_i[21] = 497;
            pmeso_grid_i[22] = 342;
            pmeso_grid_i[23] = 785;
            pmeso_grid_i[24] = 256;
            pmeso_grid_i[25] = 22;
            pmeso_grid_i[26] = 23;
            pmeso_grid_i[27] = 34;
            pmeso_grid_i[28] = 159;
            pmeso_grid_i[29] = 684;
            pmeso_grid_i[30] = 2064;
            pmeso_grid_i[31] = 545;
            pmeso_grid_i[32] = 597;
            pmeso_grid_i[33] = 720;
            pmeso_grid_i[34] = 477;
            pmeso_grid_i[35] = 394;
            pmeso_grid_i[36] = 362;
            pmeso_grid_i[37] = 14;
            pmeso_grid_i[38] = 10;
            pmeso_grid_i[39] = 52;
            pmeso_grid_i[40] = 334;
            pmeso_grid_i[41] = 1902;
            pmeso_grid_i[42] = 3385;
            pmeso_grid_i[43] = 352;
            pmeso_grid_i[44] = 878;
            pmeso_grid_i[45] = 1350;
            pmeso_grid_i[46] = 841;
            pmeso_grid_i[47] = 814;
            pmeso_grid_i[48] = 39;
            pmeso_grid_i[49] = 4;
            pmeso_grid_i[50] = 4;
            pmeso_grid_i[51] = 13;
            pmeso_grid_i[52] = 809;
            pmeso_grid_i[53] = 1352;
            pmeso_grid_i[54] = 112;
            pmeso_grid_i[55] = 15;
            pmeso_grid_i[56] = 33;
            pmeso_grid_i[57] = 486;
            pmeso_grid_i[58] = 2034;
            pmeso_grid_i[59] = 606;
            pmeso_grid_i[62] = 6;
            pmeso_grid_i[63] = 14;
            pmeso_grid_i[64] = 29;
            pmeso_grid_i[65] = 10;
            pmeso_grid_i[69] = 27;
            pmeso_grid_i[70] = 49;
            pmeso_grid_i[71] = 6;
            pmeso_grid_i[85] = 6;
            pmeso_grid_i[86] = 11;
            pmeso_grid_i[90] = 7;
            pmeso_grid_i[91] = 253;
            pmeso_grid_i[92] = 97;
            pmeso_grid_i[93] = 6;
            pmeso_grid_i[96] = 13;
            pmeso_grid_i[97] = 70;
            pmeso_grid_i[98] = 55;
            pmeso_grid_i[99] = 9;
            pmeso_grid_i[100] = 20;
            pmeso_grid_i[101] = 54;
            pmeso_grid_i[102] = 1464;
            pmeso_grid_i[103] = 3814;
            pmeso_grid_i[104] = 200;
            pmeso_grid_i[105] = 13;
            pmeso_grid_i[107] = 11;
            pmeso_grid_i[109] = 3;
            pmeso_grid_i[111] = 8;
            pmeso_grid_i[112] = 8;
            pmeso_grid_i[113] = 73;
            pmeso_grid_i[114] = 103;
            pmeso_grid_i[115] = 18;
            pmeso_grid_i[116] = 15;
            pmeso_grid_i[117] = 12;
            pmeso_grid_i[118] = 2;
            pmeso_grid_i[119] = 10;
            pmeso_grid_i[136] = 3;
            pmeso_grid_i[141] = 2;
            pmeso_grid_i[143] = 2;
        }    

        else if(!strcmp(p->res_names[i],"ASP"))
{
            pmeso_grid_i[0] = 94;
            pmeso_grid_i[1] = 5;
            pmeso_grid_i[2] = 3;
            pmeso_grid_i[3] = 3;
            pmeso_grid_i[4] = 7;
            pmeso_grid_i[5] = 4;
            pmeso_grid_i[6] = 4;
            pmeso_grid_i[7] = 5;
            pmeso_grid_i[8] = 30;
            pmeso_grid_i[9] = 57;
            pmeso_grid_i[10] = 59;
            pmeso_grid_i[11] = 294;
            pmeso_grid_i[12] = 582;
            pmeso_grid_i[13] = 20;
            pmeso_grid_i[14] = 18;
            pmeso_grid_i[15] = 22;
            pmeso_grid_i[16] = 14;
            pmeso_grid_i[17] = 39;
            pmeso_grid_i[18] = 238;
            pmeso_grid_i[19] = 197;
            pmeso_grid_i[20] = 462;
            pmeso_grid_i[21] = 692;
            pmeso_grid_i[22] = 334;
            pmeso_grid_i[23] = 677;
            pmeso_grid_i[24] = 325;
            pmeso_grid_i[25] = 34;
            pmeso_grid_i[26] = 20;
            pmeso_grid_i[27] = 58;
            pmeso_grid_i[28] = 145;
            pmeso_grid_i[29] = 577;
            pmeso_grid_i[30] = 1871;
            pmeso_grid_i[31] = 407;
            pmeso_grid_i[32] = 476;
            pmeso_grid_i[33] = 1141;
            pmeso_grid_i[34] = 427;
            pmeso_grid_i[35] = 361;
            pmeso_grid_i[36] = 793;
            pmeso_grid_i[37] = 20;
            pmeso_grid_i[38] = 18;
            pmeso_grid_i[39] = 88;
            pmeso_grid_i[40] = 1080;
            pmeso_grid_i[41] = 3969;
            pmeso_grid_i[42] = 4145;
            pmeso_grid_i[43] = 331;
            pmeso_grid_i[44] = 1424;
            pmeso_grid_i[45] = 2504;
            pmeso_grid_i[46] = 1072;
            pmeso_grid_i[47] = 940;
            pmeso_grid_i[48] = 44;
            pmeso_grid_i[49] = 6;
            pmeso_grid_i[50] = 9;
            pmeso_grid_i[51] = 32;
            pmeso_grid_i[52] = 2232;
            pmeso_grid_i[53] = 3045;
            pmeso_grid_i[54] = 161;
            pmeso_grid_i[55] = 12;
            pmeso_grid_i[56] = 99;
            pmeso_grid_i[57] = 913;
            pmeso_grid_i[58] = 4034;
            pmeso_grid_i[59] = 1407;
            pmeso_grid_i[62] = 4;
            pmeso_grid_i[63] = 17;
            pmeso_grid_i[64] = 85;
            pmeso_grid_i[65] = 9;
            pmeso_grid_i[68] = 3;
            pmeso_grid_i[69] = 63;
            pmeso_grid_i[70] = 85;
            pmeso_grid_i[71] = 2;
            pmeso_grid_i[84] = 3;
            pmeso_grid_i[85] = 8;
            pmeso_grid_i[86] = 8;
            pmeso_grid_i[90] = 4;
            pmeso_grid_i[91] = 149;
            pmeso_grid_i[92] = 77;
            pmeso_grid_i[93] = 7;
            pmeso_grid_i[94] = 2;
            pmeso_grid_i[95] = 2;
            pmeso_grid_i[96] = 28;
            pmeso_grid_i[97] = 116;
            pmeso_grid_i[98] = 58;
            pmeso_grid_i[99] = 13;
            pmeso_grid_i[100] = 21;
            pmeso_grid_i[101] = 55;
            pmeso_grid_i[102] = 789;
            pmeso_grid_i[103] = 2133;
            pmeso_grid_i[104] = 169;
            pmeso_grid_i[105] = 20;
            pmeso_grid_i[106] = 9;
            pmeso_grid_i[107] = 22;
            pmeso_grid_i[108] = 5;
            pmeso_grid_i[109] = 4;
            pmeso_grid_i[110] = 6;
            pmeso_grid_i[111] = 8;
            pmeso_grid_i[112] = 9;
            pmeso_grid_i[113] = 71;
            pmeso_grid_i[114] = 51;
            pmeso_grid_i[115] = 11;
            pmeso_grid_i[116] = 16;
            pmeso_grid_i[117] = 14;
            pmeso_grid_i[118] = 6;
            pmeso_grid_i[119] = 15;
            pmeso_grid_i[124] = 8;
            pmeso_grid_i[125] = 5;
            pmeso_grid_i[126] = 4;
            pmeso_grid_i[133] = 2;
            pmeso_grid_i[135] = 2;
            pmeso_grid_i[136] = 4;
            pmeso_grid_i[137] = 2;
            pmeso_grid_i[138] = 2;
            pmeso_grid_i[141] = 3;
            pmeso_grid_i[142] = 2;
        }
        else if(!strcmp(p->res_names[i],"CYS"))
{
            pmeso_grid_i[0] = 26;
            pmeso_grid_i[3] = 3;
            pmeso_grid_i[8] = 3;
            pmeso_grid_i[9] = 12;
            pmeso_grid_i[10] = 39;
            pmeso_grid_i[11] = 146;
            pmeso_grid_i[12] = 110;
            pmeso_grid_i[13] = 6;
            pmeso_grid_i[15] = 8;
            pmeso_grid_i[16] = 5;
            pmeso_grid_i[17] = 13;
            pmeso_grid_i[18] = 40;
            pmeso_grid_i[19] = 37;
            pmeso_grid_i[20] = 113;
            pmeso_grid_i[21] = 71;
            pmeso_grid_i[22] = 183;
            pmeso_grid_i[23] = 369;
            pmeso_grid_i[24] = 52;
            pmeso_grid_i[25] = 26;
            pmeso_grid_i[26] = 6;
            pmeso_grid_i[27] = 15;
            pmeso_grid_i[28] = 83;
            pmeso_grid_i[29] = 264;
            pmeso_grid_i[30] = 262;
            pmeso_grid_i[31] = 107;
            pmeso_grid_i[32] = 124;
            pmeso_grid_i[33] = 174;
            pmeso_grid_i[34] = 282;
            pmeso_grid_i[35] = 239;
            pmeso_grid_i[36] = 41;
            pmeso_grid_i[37] = 4;
            pmeso_grid_i[39] = 18;
            pmeso_grid_i[40] = 99;
            pmeso_grid_i[41] = 463;
            pmeso_grid_i[42] = 341;
            pmeso_grid_i[43] = 33;
            pmeso_grid_i[44] = 95;
            pmeso_grid_i[45] = 221;
            pmeso_grid_i[46] = 478;
            pmeso_grid_i[47] = 293;
            pmeso_grid_i[51] = 7;
            pmeso_grid_i[52] = 351;
            pmeso_grid_i[53] = 483;
            pmeso_grid_i[54] = 11;
            pmeso_grid_i[56] = 5;
            pmeso_grid_i[57] = 74;
            pmeso_grid_i[58] = 925;
            pmeso_grid_i[59] = 262;
            pmeso_grid_i[63] = 2;
            pmeso_grid_i[64] = 11;
            pmeso_grid_i[65] = 3;
            pmeso_grid_i[69] = 15;
            pmeso_grid_i[70] = 23;
            pmeso_grid_i[91] = 15;
            pmeso_grid_i[92] = 7;
            pmeso_grid_i[96] = 4;
            pmeso_grid_i[97] = 16;
            pmeso_grid_i[98] = 2;
            pmeso_grid_i[100] = 2;
            pmeso_grid_i[102] = 117;
            pmeso_grid_i[103] = 193;
            pmeso_grid_i[104] = 19;
            pmeso_grid_i[105] = 4;
            pmeso_grid_i[109] = 2;
            pmeso_grid_i[111] = 2;
            pmeso_grid_i[113] = 13;
            pmeso_grid_i[114] = 12;
            pmeso_grid_i[117] = 5;
            pmeso_grid_i[118] = 2;
            pmeso_grid_i[119] = 2;
        }
        else if(!strcmp(p->res_names[i],"GLN"))
{
            pmeso_grid_i[0] = 14;
            pmeso_grid_i[3] = 2;
            pmeso_grid_i[4] = 4;
            pmeso_grid_i[5] = 3;
            pmeso_grid_i[6] = 4;
            pmeso_grid_i[8] = 4;
            pmeso_grid_i[9] = 9;
            pmeso_grid_i[10] = 45;
            pmeso_grid_i[11] = 130;
            pmeso_grid_i[12] = 39;
            pmeso_grid_i[13] = 3;
            pmeso_grid_i[14] = 3;
            pmeso_grid_i[15] = 4;
            pmeso_grid_i[16] = 9;
            pmeso_grid_i[17] = 21;
            pmeso_grid_i[18] = 37;
            pmeso_grid_i[19] = 47;
            pmeso_grid_i[20] = 105;
            pmeso_grid_i[21] = 103;
            pmeso_grid_i[22] = 399;
            pmeso_grid_i[23] = 561;
            pmeso_grid_i[24] = 69;
            pmeso_grid_i[25] = 12;
            pmeso_grid_i[26] = 19;
            pmeso_grid_i[27] = 34;
            pmeso_grid_i[28] = 176;
            pmeso_grid_i[29] = 454;
            pmeso_grid_i[30] = 644;
            pmeso_grid_i[31] = 155;
            pmeso_grid_i[32] = 236;
            pmeso_grid_i[33] = 259;
            pmeso_grid_i[34] = 750;
            pmeso_grid_i[35] = 633;
            pmeso_grid_i[36] = 60;
            pmeso_grid_i[37] = 11;
            pmeso_grid_i[38] = 13;
            pmeso_grid_i[39] = 41;
            pmeso_grid_i[40] = 472;
            pmeso_grid_i[41] = 1533;
            pmeso_grid_i[42] = 1111;
            pmeso_grid_i[43] = 79;
            pmeso_grid_i[44] = 254;
            pmeso_grid_i[45] = 342;
            pmeso_grid_i[46] = 928;
            pmeso_grid_i[47] = 689;
            pmeso_grid_i[48] = 4;
            pmeso_grid_i[50] = 5;
            pmeso_grid_i[51] = 22;
            pmeso_grid_i[52] = 1238;
            pmeso_grid_i[53] = 1379;
            pmeso_grid_i[54] = 41;
            pmeso_grid_i[55] = 5;
            pmeso_grid_i[56] = 19;
            pmeso_grid_i[57] = 158;
            pmeso_grid_i[58] = 1951;
            pmeso_grid_i[59] = 500;
            pmeso_grid_i[62] = 4;
            pmeso_grid_i[63] = 12;
            pmeso_grid_i[64] = 39;
            pmeso_grid_i[65] = 5;
            pmeso_grid_i[68] = 2;
            pmeso_grid_i[69] = 9;
            pmeso_grid_i[70] = 32;
            pmeso_grid_i[71] = 5;
            pmeso_grid_i[84] = 3;
            pmeso_grid_i[85] = 3;
            pmeso_grid_i[86] = 2;
            pmeso_grid_i[91] = 54;
            pmeso_grid_i[92] = 18;
            pmeso_grid_i[96] = 6;
            pmeso_grid_i[97] = 43;
            pmeso_grid_i[98] = 17;
            pmeso_grid_i[99] = 6;
            pmeso_grid_i[100] = 12;
            pmeso_grid_i[101] = 12;
            pmeso_grid_i[102] = 268;
            pmeso_grid_i[103] = 725;
            pmeso_grid_i[104] = 48;
            pmeso_grid_i[106] = 3;
            pmeso_grid_i[107] = 5;
            pmeso_grid_i[110] = 3;
            pmeso_grid_i[111] = 2;
            pmeso_grid_i[112] = 4;
            pmeso_grid_i[113] = 10;
            pmeso_grid_i[114] = 24;
            pmeso_grid_i[115] = 4;
            pmeso_grid_i[116] = 4;
            pmeso_grid_i[117] = 6;
            pmeso_grid_i[118] = 7;
            pmeso_grid_i[119] = 3;
            pmeso_grid_i[129] = 2;
            pmeso_grid_i[140] = 3;
        }
        else if(!strcmp(p->res_names[i],"GLU"))
{
            pmeso_grid_i[0] = 19;
            pmeso_grid_i[1] = 2;
            pmeso_grid_i[3] = 6;
            pmeso_grid_i[4] = 8;
            pmeso_grid_i[5] = 6;
            pmeso_grid_i[6] = 5;
            pmeso_grid_i[7] = 3;
            pmeso_grid_i[8] = 7;
            pmeso_grid_i[9] = 12;
            pmeso_grid_i[10] = 79;
            pmeso_grid_i[11] = 164;
            pmeso_grid_i[12] = 56;
            pmeso_grid_i[13] = 6;
            pmeso_grid_i[14] = 5;
            pmeso_grid_i[15] = 9;
            pmeso_grid_i[16] = 23;
            pmeso_grid_i[17] = 37;
            pmeso_grid_i[18] = 38;
            pmeso_grid_i[19] = 65;
            pmeso_grid_i[20] = 123;
            pmeso_grid_i[21] = 116;
            pmeso_grid_i[22] = 658;
            pmeso_grid_i[23] = 768;
            pmeso_grid_i[24] = 62;
            pmeso_grid_i[25] = 22;
            pmeso_grid_i[26] = 24;
            pmeso_grid_i[27] = 42;
            pmeso_grid_i[28] = 253;
            pmeso_grid_i[29] = 644;
            pmeso_grid_i[30] = 779;
            pmeso_grid_i[31] = 188;
            pmeso_grid_i[32] = 235;
            pmeso_grid_i[33] = 355;
            pmeso_grid_i[34] = 954;
            pmeso_grid_i[35] = 679;
            pmeso_grid_i[36] = 66;
            pmeso_grid_i[37] = 10;
            pmeso_grid_i[38] = 18;
            pmeso_grid_i[39] = 57;
            pmeso_grid_i[40] = 916;
            pmeso_grid_i[41] = 2675;
            pmeso_grid_i[42] = 1459;
            pmeso_grid_i[43] = 103;
            pmeso_grid_i[44] = 344;
            pmeso_grid_i[45] = 504;
            pmeso_grid_i[46] = 1342;
            pmeso_grid_i[47] = 943;
            pmeso_grid_i[48] = 12;
            pmeso_grid_i[49] = 4;
            pmeso_grid_i[50] = 2;
            pmeso_grid_i[51] = 43;
            pmeso_grid_i[52] = 3425;
            pmeso_grid_i[53] = 3998;
            pmeso_grid_i[54] = 84;
            pmeso_grid_i[55] = 14;
            pmeso_grid_i[56] = 25;
            pmeso_grid_i[57] = 244;
            pmeso_grid_i[58] = 4195;
            pmeso_grid_i[59] = 1037;
            pmeso_grid_i[62] = 3;
            pmeso_grid_i[63] = 24;
            pmeso_grid_i[64] = 160;
            pmeso_grid_i[65] = 9;
            pmeso_grid_i[69] = 21;
            pmeso_grid_i[70] = 81;
            pmeso_grid_i[71] = 5;
            pmeso_grid_i[85] = 9;
            pmeso_grid_i[86] = 9;
            pmeso_grid_i[91] = 87;
            pmeso_grid_i[92] = 42;
            pmeso_grid_i[93] = 5;
            pmeso_grid_i[96] = 13;
            pmeso_grid_i[97] = 48;
            pmeso_grid_i[98] = 24;
            pmeso_grid_i[99] = 14;
            pmeso_grid_i[100] = 22;
            pmeso_grid_i[101] = 22;
            pmeso_grid_i[102] = 313;
            pmeso_grid_i[103] = 764;
            pmeso_grid_i[104] = 66;
            pmeso_grid_i[105] = 15;
            pmeso_grid_i[106] = 3;
            pmeso_grid_i[107] = 6;
            pmeso_grid_i[109] = 2;
            pmeso_grid_i[110] = 2;
            pmeso_grid_i[111] = 10;
            pmeso_grid_i[112] = 13;
            pmeso_grid_i[113] = 33;
            pmeso_grid_i[114] = 23;
            pmeso_grid_i[115] = 6;
            pmeso_grid_i[116] = 6;
            pmeso_grid_i[117] = 11;
            pmeso_grid_i[118] = 5;
            pmeso_grid_i[119] = 4;
            pmeso_grid_i[124] = 2;
            pmeso_grid_i[125] = 4;
            pmeso_grid_i[129] = 2;
            pmeso_grid_i[131] = 2;
            pmeso_grid_i[136] = 3;
            pmeso_grid_i[137] = 2;
            pmeso_grid_i[141] = 5;
            pmeso_grid_i[142] = 2;
            pmeso_grid_i[143] = 2;
        }
        else if(!strcmp(p->res_names[i],"HIS"))
{
            pmeso_grid_i[0] = 19;
            pmeso_grid_i[2] = 2;
            pmeso_grid_i[3] = 2;
            pmeso_grid_i[5] = 2;
            pmeso_grid_i[6] = 4;
            pmeso_grid_i[8] = 4;
            pmeso_grid_i[9] = 13;
            pmeso_grid_i[10] = 77;
            pmeso_grid_i[11] = 173;
            pmeso_grid_i[12] = 76;
            pmeso_grid_i[13] = 6;
            pmeso_grid_i[14] = 3;
            pmeso_grid_i[15] = 16;
            pmeso_grid_i[16] = 17;
            pmeso_grid_i[17] = 35;
            pmeso_grid_i[18] = 68;
            pmeso_grid_i[19] = 95;
            pmeso_grid_i[20] = 184;
            pmeso_grid_i[21] = 106;
            pmeso_grid_i[22] = 411;
            pmeso_grid_i[23] = 599;
            pmeso_grid_i[24] = 49;
            pmeso_grid_i[25] = 10;
            pmeso_grid_i[26] = 13;
            pmeso_grid_i[27] = 43;
            pmeso_grid_i[28] = 145;
            pmeso_grid_i[29] = 499;
            pmeso_grid_i[30] = 838;
            pmeso_grid_i[31] = 261;
            pmeso_grid_i[32] = 293;
            pmeso_grid_i[33] = 197;
            pmeso_grid_i[34] = 474;
            pmeso_grid_i[35] = 405;
            pmeso_grid_i[36] = 44;
            pmeso_grid_i[37] = 3;
            pmeso_grid_i[38] = 6;
            pmeso_grid_i[39] = 45;
            pmeso_grid_i[40] = 247;
            pmeso_grid_i[41] = 938;
            pmeso_grid_i[42] = 871;
            pmeso_grid_i[43] = 81;
            pmeso_grid_i[44] = 254;
            pmeso_grid_i[45] = 247;
            pmeso_grid_i[46] = 525;
            pmeso_grid_i[47] = 291;
            pmeso_grid_i[48] = 4;
            pmeso_grid_i[51] = 10;
            pmeso_grid_i[52] = 695;
            pmeso_grid_i[53] = 917;
            pmeso_grid_i[54] = 26;
            pmeso_grid_i[55] = 4;
            pmeso_grid_i[56] = 12;
            pmeso_grid_i[57] = 108;
            pmeso_grid_i[58] = 1524;
            pmeso_grid_i[59] = 391;
            pmeso_grid_i[63] = 3;
            pmeso_grid_i[64] = 22;
            pmeso_grid_i[65] = 2;
            pmeso_grid_i[69] = 5;
            pmeso_grid_i[70] = 27;
            pmeso_grid_i[71] = 3;
            pmeso_grid_i[85] = 5;
            pmeso_grid_i[91] = 53;
            pmeso_grid_i[92] = 17;
            pmeso_grid_i[96] = 3;
            pmeso_grid_i[97] = 29;
            pmeso_grid_i[98] = 11;
            pmeso_grid_i[99] = 4;
            pmeso_grid_i[100] = 11;
            pmeso_grid_i[101] = 18;
            pmeso_grid_i[102] = 301;
            pmeso_grid_i[103] = 642;
            pmeso_grid_i[104] = 53;
            pmeso_grid_i[105] = 4;
            pmeso_grid_i[107] = 3;
            pmeso_grid_i[111] = 6;
            pmeso_grid_i[112] = 6;
            pmeso_grid_i[113] = 23;
            pmeso_grid_i[114] = 25;
            pmeso_grid_i[115] = 3;
            pmeso_grid_i[116] = 4;
            pmeso_grid_i[117] = 5;
            pmeso_grid_i[118] = 7;
            pmeso_grid_i[119] = 2;
            pmeso_grid_i[125] = 2;
            pmeso_grid_i[140] = 2;
        }
        else if(!strcmp(p->res_names[i],"ILE"))
{
            pmeso_grid_i[9] = 4;
            pmeso_grid_i[10] = 25;
            pmeso_grid_i[11] = 21;
            pmeso_grid_i[12] = 25;
            pmeso_grid_i[15] = 3;
            pmeso_grid_i[16] = 14;
            pmeso_grid_i[17] = 17;
            pmeso_grid_i[18] = 20;
            pmeso_grid_i[19] = 19;
            pmeso_grid_i[20] = 35;
            pmeso_grid_i[21] = 102;
            pmeso_grid_i[22] = 531;
            pmeso_grid_i[23] = 395;
            pmeso_grid_i[24] = 64;
            pmeso_grid_i[26] = 6;
            pmeso_grid_i[27] = 91;
            pmeso_grid_i[28] = 375;
            pmeso_grid_i[29] = 666;
            pmeso_grid_i[30] = 755;
            pmeso_grid_i[31] = 106;
            pmeso_grid_i[32] = 197;
            pmeso_grid_i[33] = 1019;
            pmeso_grid_i[34] = 1919;
            pmeso_grid_i[35] = 791;
            pmeso_grid_i[36] = 15;
            pmeso_grid_i[38] = 3;
            pmeso_grid_i[39] = 93;
            pmeso_grid_i[40] = 825;
            pmeso_grid_i[41] = 685;
            pmeso_grid_i[42] = 458;
            pmeso_grid_i[43] = 13;
            pmeso_grid_i[44] = 182;
            pmeso_grid_i[45] = 1393;
            pmeso_grid_i[46] = 2224;
            pmeso_grid_i[47] = 251;
            pmeso_grid_i[48] = 2;
            pmeso_grid_i[50] = 2;
            pmeso_grid_i[51] = 13;
            pmeso_grid_i[52] = 1301;
            pmeso_grid_i[53] = 1170;
            pmeso_grid_i[54] = 14;
            pmeso_grid_i[55] = 2;
            pmeso_grid_i[56] = 7;
            pmeso_grid_i[57] = 275;
            pmeso_grid_i[58] = 2618;
            pmeso_grid_i[59] = 275;
            pmeso_grid_i[63] = 5;
            pmeso_grid_i[64] = 35;
            pmeso_grid_i[69] = 4;
            pmeso_grid_i[70] = 23;
            pmeso_grid_i[85] = 3;
            pmeso_grid_i[89] = 4;
            pmeso_grid_i[90] = 2;
            pmeso_grid_i[91] = 16;
            pmeso_grid_i[92] = 5;
            pmeso_grid_i[97] = 4;
            pmeso_grid_i[98] = 9;
            pmeso_grid_i[99] = 9;
            pmeso_grid_i[100] = 15;
            pmeso_grid_i[102] = 3;
            pmeso_grid_i[103] = 18;
            pmeso_grid_i[104] = 13;
            pmeso_grid_i[105] = 10;
            pmeso_grid_i[111] = 2;
            pmeso_grid_i[112] = 8;
            pmeso_grid_i[116] = 3;
            pmeso_grid_i[117] = 7;
            pmeso_grid_i[118] = 4;
        }
        else if(!strcmp(p->res_names[i],"LEU"))
{
            pmeso_grid_i[0] = 4;
            pmeso_grid_i[1] = 2;
            pmeso_grid_i[3] = 5;
            pmeso_grid_i[4] = 5;
            pmeso_grid_i[5] = 3;
            pmeso_grid_i[6] = 3;
            pmeso_grid_i[8] = 3;
            pmeso_grid_i[9] = 11;
            pmeso_grid_i[10] = 49;
            pmeso_grid_i[11] = 72;
            pmeso_grid_i[12] = 39;
            pmeso_grid_i[13] = 4;
            pmeso_grid_i[14] = 2;
            pmeso_grid_i[15] = 14;
            pmeso_grid_i[16] = 22;
            pmeso_grid_i[17] = 20;
            pmeso_grid_i[18] = 29;
            pmeso_grid_i[19] = 38;
            pmeso_grid_i[20] = 121;
            pmeso_grid_i[21] = 152;
            pmeso_grid_i[22] = 437;
            pmeso_grid_i[23] = 320;
            pmeso_grid_i[24] = 91;
            pmeso_grid_i[25] = 22;
            pmeso_grid_i[26] = 19;
            pmeso_grid_i[27] = 64;
            pmeso_grid_i[28] = 433;
            pmeso_grid_i[29] = 886;
            pmeso_grid_i[30] = 1195;
            pmeso_grid_i[31] = 292;
            pmeso_grid_i[32] = 386;
            pmeso_grid_i[33] = 586;
            pmeso_grid_i[34] = 1607;
            pmeso_grid_i[35] = 1091;
            pmeso_grid_i[36] = 118;
            pmeso_grid_i[37] = 19;
            pmeso_grid_i[38] = 17;
            pmeso_grid_i[39] = 82;
            pmeso_grid_i[40] = 1179;
            pmeso_grid_i[41] = 2862;
            pmeso_grid_i[42] = 2226;
            pmeso_grid_i[43] = 171;
            pmeso_grid_i[44] = 603;
            pmeso_grid_i[45] = 933;
            pmeso_grid_i[46] = 2736;
            pmeso_grid_i[47] = 1587;
            pmeso_grid_i[48] = 16;
            pmeso_grid_i[49] = 2;
            pmeso_grid_i[50] = 2;
            pmeso_grid_i[51] = 35;
            pmeso_grid_i[52] = 2746;
            pmeso_grid_i[53] = 2122;
            pmeso_grid_i[54] = 75;
            pmeso_grid_i[55] = 7;
            pmeso_grid_i[56] = 28;
            pmeso_grid_i[57] = 410;
            pmeso_grid_i[58] = 5464;
            pmeso_grid_i[59] = 1153;
            pmeso_grid_i[63] = 11;
            pmeso_grid_i[64] = 65;
            pmeso_grid_i[65] = 9;
            pmeso_grid_i[68] = 2;
            pmeso_grid_i[69] = 16;
            pmeso_grid_i[70] = 53;
            pmeso_grid_i[71] = 4;
            pmeso_grid_i[85] = 5;
            pmeso_grid_i[88] = 2;
            pmeso_grid_i[91] = 25;
            pmeso_grid_i[92] = 15;
            pmeso_grid_i[93] = 4;
            pmeso_grid_i[96] = 6;
            pmeso_grid_i[97] = 40;
            pmeso_grid_i[98] = 18;
            pmeso_grid_i[99] = 8;
            pmeso_grid_i[100] = 18;
            pmeso_grid_i[101] = 12;
            pmeso_grid_i[102] = 296;
            pmeso_grid_i[103] = 370;
            pmeso_grid_i[104] = 44;
            pmeso_grid_i[105] = 6;
            pmeso_grid_i[106] = 2;
            pmeso_grid_i[107] = 12;
            pmeso_grid_i[111] = 9;
            pmeso_grid_i[112] = 12;
            pmeso_grid_i[113] = 28;
            pmeso_grid_i[114] = 28;
            pmeso_grid_i[115] = 3;
            pmeso_grid_i[116] = 6;
            pmeso_grid_i[117] = 4;
            pmeso_grid_i[118] = 5;
            pmeso_grid_i[128] = 2;
            pmeso_grid_i[130] = 2;
            pmeso_grid_i[141] = 2;
        }
        else if(!strcmp(p->res_names[i],"LYS"))
{
            pmeso_grid_i[0] = 14;
            pmeso_grid_i[1] = 2;
            pmeso_grid_i[2] = 2;
            pmeso_grid_i[4] = 5;
            pmeso_grid_i[5] = 8;
            pmeso_grid_i[6] = 2;
            pmeso_grid_i[7] = 2;
            pmeso_grid_i[8] = 6;
            pmeso_grid_i[9] = 16;
            pmeso_grid_i[10] = 66;
            pmeso_grid_i[11] = 208;
            pmeso_grid_i[12] = 32;
            pmeso_grid_i[13] = 6;
            pmeso_grid_i[14] = 10;
            pmeso_grid_i[15] = 13;
            pmeso_grid_i[16] = 32;
            pmeso_grid_i[17] = 49;
            pmeso_grid_i[18] = 63;
            pmeso_grid_i[19] = 58;
            pmeso_grid_i[20] = 141;
            pmeso_grid_i[21] = 145;
            pmeso_grid_i[22] = 680;
            pmeso_grid_i[23] = 792;
            pmeso_grid_i[24] = 90;
            pmeso_grid_i[25] = 33;
            pmeso_grid_i[26] = 27;
            pmeso_grid_i[27] = 54;
            pmeso_grid_i[28] = 397;
            pmeso_grid_i[29] = 866;
            pmeso_grid_i[30] = 935;
            pmeso_grid_i[31] = 199;
            pmeso_grid_i[32] = 276;
            pmeso_grid_i[33] = 353;
            pmeso_grid_i[34] = 1310;
            pmeso_grid_i[35] = 1077;
            pmeso_grid_i[36] = 68;
            pmeso_grid_i[37] = 14;
            pmeso_grid_i[38] = 22;
            pmeso_grid_i[39] = 68;
            pmeso_grid_i[40] = 1046;
            pmeso_grid_i[41] = 2492;
            pmeso_grid_i[42] = 1479;
            pmeso_grid_i[43] = 111;
            pmeso_grid_i[44] = 371;
            pmeso_grid_i[45] = 455;
            pmeso_grid_i[46] = 1477;
            pmeso_grid_i[47] = 1013;
            pmeso_grid_i[48] = 15;
            pmeso_grid_i[49] = 6;
            pmeso_grid_i[50] = 10;
            pmeso_grid_i[51] = 54;
            pmeso_grid_i[52] = 2616;
            pmeso_grid_i[53] = 2547;
            pmeso_grid_i[54] = 62;
            pmeso_grid_i[55] = 11;
            pmeso_grid_i[56] = 21;
            pmeso_grid_i[57] = 257;
            pmeso_grid_i[58] = 3738;
            pmeso_grid_i[59] = 829;
            pmeso_grid_i[62] = 4;
            pmeso_grid_i[63] = 35;
            pmeso_grid_i[64] = 122;
            pmeso_grid_i[65] = 14;
            pmeso_grid_i[66] = 2;
            pmeso_grid_i[69] = 24;
            pmeso_grid_i[70] = 76;
            pmeso_grid_i[71] = 9;
            pmeso_grid_i[84] = 3;
            pmeso_grid_i[85] = 11;
            pmeso_grid_i[86] = 6;
            pmeso_grid_i[90] = 4;
            pmeso_grid_i[91] = 90;
            pmeso_grid_i[92] = 35;
            pmeso_grid_i[93] = 5;
            pmeso_grid_i[96] = 17;
            pmeso_grid_i[97] = 83;
            pmeso_grid_i[98] = 28;
            pmeso_grid_i[99] = 10;
            pmeso_grid_i[100] = 27;
            pmeso_grid_i[101] = 29;
            pmeso_grid_i[102] = 517;
            pmeso_grid_i[103] = 1268;
            pmeso_grid_i[104] = 95;
            pmeso_grid_i[105] = 7;
            pmeso_grid_i[106] = 6;
            pmeso_grid_i[107] = 8;
            pmeso_grid_i[109] = 4;
            pmeso_grid_i[110] = 4;
            pmeso_grid_i[111] = 4;
            pmeso_grid_i[112] = 13;
            pmeso_grid_i[113] = 34;
            pmeso_grid_i[114] = 26;
            pmeso_grid_i[115] = 14;
            pmeso_grid_i[116] = 7;
            pmeso_grid_i[117] = 5;
            pmeso_grid_i[118] = 3;
            pmeso_grid_i[119] = 2;
            pmeso_grid_i[130] = 2;
            pmeso_grid_i[131] = 2;
            pmeso_grid_i[133] = 2;
            pmeso_grid_i[136] = 3;
            pmeso_grid_i[137] = 3;
            pmeso_grid_i[139] = 3;
            pmeso_grid_i[140] = 3;
            pmeso_grid_i[142] = 3;
        }
        else if(!strcmp(p->res_names[i],"MET"))
{
            pmeso_grid_i[0] = 8;
            pmeso_grid_i[5] = 3;
            pmeso_grid_i[8] = 3;
            pmeso_grid_i[9] = 5;
            pmeso_grid_i[10] = 23;
            pmeso_grid_i[11] = 87;
            pmeso_grid_i[12] = 28;
            pmeso_grid_i[13] = 4;
            pmeso_grid_i[15] = 4;
            pmeso_grid_i[16] = 8;
            pmeso_grid_i[17] = 10;
            pmeso_grid_i[18] = 25;
            pmeso_grid_i[19] = 29;
            pmeso_grid_i[20] = 53;
            pmeso_grid_i[21] = 32;
            pmeso_grid_i[22] = 195;
            pmeso_grid_i[23] = 241;
            pmeso_grid_i[24] = 29;
            pmeso_grid_i[25] = 5;
            pmeso_grid_i[26] = 7;
            pmeso_grid_i[27] = 15;
            pmeso_grid_i[28] = 56;
            pmeso_grid_i[29] = 163;
            pmeso_grid_i[30] = 297;
            pmeso_grid_i[31] = 70;
            pmeso_grid_i[32] = 105;
            pmeso_grid_i[33] = 116;
            pmeso_grid_i[34] = 279;
            pmeso_grid_i[35] = 215;
            pmeso_grid_i[36] = 29;
            pmeso_grid_i[37] = 8;
            pmeso_grid_i[38] = 5;
            pmeso_grid_i[39] = 16;
            pmeso_grid_i[40] = 158;
            pmeso_grid_i[41] = 511;
            pmeso_grid_i[42] = 464;
            pmeso_grid_i[43] = 45;
            pmeso_grid_i[44] = 171;
            pmeso_grid_i[45] = 151;
            pmeso_grid_i[46] = 485;
            pmeso_grid_i[47] = 291;
            pmeso_grid_i[48] = 3;
            pmeso_grid_i[51] = 9;
            pmeso_grid_i[52] = 424;
            pmeso_grid_i[53] = 471;
            pmeso_grid_i[54] = 15;
            pmeso_grid_i[55] = 3;
            pmeso_grid_i[56] = 8;
            pmeso_grid_i[57] = 81;
            pmeso_grid_i[58] = 1048;
            pmeso_grid_i[59] = 275;
            pmeso_grid_i[64] = 17;
            pmeso_grid_i[69] = 4;
            pmeso_grid_i[70] = 17;
            pmeso_grid_i[85] = 2;
            pmeso_grid_i[91] = 12;
            pmeso_grid_i[92] = 4;
            pmeso_grid_i[96] = 4;
            pmeso_grid_i[97] = 11;
            pmeso_grid_i[98] = 2;
            pmeso_grid_i[99] = 2;
            pmeso_grid_i[100] = 2;
            pmeso_grid_i[101] = 5;
            pmeso_grid_i[102] = 112;
            pmeso_grid_i[103] = 162;
            pmeso_grid_i[104] = 9;
            pmeso_grid_i[105] = 4;
            pmeso_grid_i[113] = 7;
            pmeso_grid_i[114] = 8;
            pmeso_grid_i[115] = 2;
            pmeso_grid_i[117] = 3;
            pmeso_grid_i[118] = 2;
            pmeso_grid_i[119] = 2;
        }
        else if(!strcmp(p->res_names[i],"PHE"))
{
            pmeso_grid_i[0] = 9;
            pmeso_grid_i[4] = 2;
            pmeso_grid_i[5] = 2;
            pmeso_grid_i[8] = 4;
            pmeso_grid_i[9] = 11;
            pmeso_grid_i[10] = 75;
            pmeso_grid_i[11] = 306;
            pmeso_grid_i[12] = 61;
            pmeso_grid_i[13] = 3;
            pmeso_grid_i[14] = 3;
            pmeso_grid_i[15] = 26;
            pmeso_grid_i[16] = 18;
            pmeso_grid_i[17] = 67;
            pmeso_grid_i[18] = 58;
            pmeso_grid_i[19] = 49;
            pmeso_grid_i[20] = 131;
            pmeso_grid_i[21] = 114;
            pmeso_grid_i[22] = 469;
            pmeso_grid_i[23] = 712;
            pmeso_grid_i[24] = 70;
            pmeso_grid_i[25] = 10;
            pmeso_grid_i[26] = 13;
            pmeso_grid_i[27] = 48;
            pmeso_grid_i[28] = 167;
            pmeso_grid_i[29] = 766;
            pmeso_grid_i[30] = 1103;
            pmeso_grid_i[31] = 308;
            pmeso_grid_i[32] = 491;
            pmeso_grid_i[33] = 359;
            pmeso_grid_i[34] = 949;
            pmeso_grid_i[35] = 729;
            pmeso_grid_i[36] = 44;
            pmeso_grid_i[37] = 14;
            pmeso_grid_i[38] = 7;
            pmeso_grid_i[39] = 58;
            pmeso_grid_i[40] = 317;
            pmeso_grid_i[41] = 980;
            pmeso_grid_i[42] = 1206;
            pmeso_grid_i[43] = 98;
            pmeso_grid_i[44] = 332;
            pmeso_grid_i[45] = 416;
            pmeso_grid_i[46] = 1052;
            pmeso_grid_i[47] = 575;
            pmeso_grid_i[48] = 4;
            pmeso_grid_i[50] = 2;
            pmeso_grid_i[51] = 19;
            pmeso_grid_i[52] = 1114;
            pmeso_grid_i[53] = 886;
            pmeso_grid_i[54] = 27;
            pmeso_grid_i[55] = 2;
            pmeso_grid_i[56] = 6;
            pmeso_grid_i[57] = 165;
            pmeso_grid_i[58] = 2206;
            pmeso_grid_i[59] = 429;
            pmeso_grid_i[63] = 5;
            pmeso_grid_i[64] = 40;
            pmeso_grid_i[69] = 7;
            pmeso_grid_i[70] = 44;
            pmeso_grid_i[91] = 30;
            pmeso_grid_i[92] = 11;
            pmeso_grid_i[96] = 11;
            pmeso_grid_i[97] = 23;
            pmeso_grid_i[98] = 8;
            pmeso_grid_i[99] = 2;
            pmeso_grid_i[100] = 14;
            pmeso_grid_i[101] = 18;
            pmeso_grid_i[102] = 265;
            pmeso_grid_i[103] = 354;
            pmeso_grid_i[104] = 29;
            pmeso_grid_i[106] = 5;
            pmeso_grid_i[107] = 2;
            pmeso_grid_i[111] = 2;
            pmeso_grid_i[112] = 5;
            pmeso_grid_i[113] = 24;
            pmeso_grid_i[114] = 31;
            pmeso_grid_i[115] = 4;
            pmeso_grid_i[116] = 2;
            pmeso_grid_i[117] = 3;
            pmeso_grid_i[118] = 5;
            pmeso_grid_i[119] = 6;
        }
        else if(!strcmp(p->res_names[i],"SER"))
{
            pmeso_grid_i[0] = 105;
            pmeso_grid_i[1] = 6;
            pmeso_grid_i[2] = 3;
            pmeso_grid_i[3] = 6;
            pmeso_grid_i[4] = 7;
            pmeso_grid_i[5] = 10;
            pmeso_grid_i[6] = 6;
            pmeso_grid_i[7] = 7;
            pmeso_grid_i[8] = 20;
            pmeso_grid_i[9] = 27;
            pmeso_grid_i[10] = 169;
            pmeso_grid_i[11] = 797;
            pmeso_grid_i[12] = 557;
            pmeso_grid_i[13] = 28;
            pmeso_grid_i[14] = 19;
            pmeso_grid_i[15] = 42;
            pmeso_grid_i[16] = 46;
            pmeso_grid_i[17] = 111;
            pmeso_grid_i[18] = 175;
            pmeso_grid_i[19] = 120;
            pmeso_grid_i[20] = 200;
            pmeso_grid_i[21] = 206;
            pmeso_grid_i[22] = 1086;
            pmeso_grid_i[23] = 2335;
            pmeso_grid_i[24] = 231;
            pmeso_grid_i[25] = 42;
            pmeso_grid_i[26] = 27;
            pmeso_grid_i[27] = 85;
            pmeso_grid_i[28] = 200;
            pmeso_grid_i[29] = 824;
            pmeso_grid_i[30] = 1142;
            pmeso_grid_i[31] = 243;
            pmeso_grid_i[32] = 225;
            pmeso_grid_i[33] = 285;
            pmeso_grid_i[34] = 883;
            pmeso_grid_i[35] = 997;
            pmeso_grid_i[36] = 295;
            pmeso_grid_i[37] = 30;
            pmeso_grid_i[38] = 15;
            pmeso_grid_i[39] = 74;
            pmeso_grid_i[40] = 532;
            pmeso_grid_i[41] = 3772;
            pmeso_grid_i[42] = 1627;
            pmeso_grid_i[43] = 127;
            pmeso_grid_i[44] = 262;
            pmeso_grid_i[45] = 339;
            pmeso_grid_i[46] = 1391;
            pmeso_grid_i[47] = 2380;
            pmeso_grid_i[48] = 43;
            pmeso_grid_i[49] = 7;
            pmeso_grid_i[50] = 7;
            pmeso_grid_i[51] = 41;
            pmeso_grid_i[52] = 2213;
            pmeso_grid_i[53] = 4923;
            pmeso_grid_i[54] = 81;
            pmeso_grid_i[55] = 18;
            pmeso_grid_i[56] = 22;
            pmeso_grid_i[57] = 183;
            pmeso_grid_i[58] = 4063;
            pmeso_grid_i[59] = 3058;
            pmeso_grid_i[62] = 5;
            pmeso_grid_i[63] = 24;
            pmeso_grid_i[64] = 82;
            pmeso_grid_i[65] = 11;
            pmeso_grid_i[68] = 4;
            pmeso_grid_i[69] = 30;
            pmeso_grid_i[70] = 100;
            pmeso_grid_i[71] = 6;
            pmeso_grid_i[84] = 2;
            pmeso_grid_i[85] = 12;
            pmeso_grid_i[86] = 10;
            pmeso_grid_i[87] = 4;
            pmeso_grid_i[90] = 2;
            pmeso_grid_i[91] = 94;
            pmeso_grid_i[92] = 44;
            pmeso_grid_i[93] = 7;
            pmeso_grid_i[95] = 2;
            pmeso_grid_i[96] = 47;
            pmeso_grid_i[97] = 74;
            pmeso_grid_i[98] = 29;
            pmeso_grid_i[99] = 12;
            pmeso_grid_i[100] = 29;
            pmeso_grid_i[101] = 37;
            pmeso_grid_i[102] = 363;
            pmeso_grid_i[103] = 789;
            pmeso_grid_i[104] = 67;
            pmeso_grid_i[105] = 15;
            pmeso_grid_i[106] = 12;
            pmeso_grid_i[107] = 15;
            pmeso_grid_i[108] = 6;
            pmeso_grid_i[109] = 4;
            pmeso_grid_i[110] = 8;
            pmeso_grid_i[111] = 15;
            pmeso_grid_i[112] = 13;
            pmeso_grid_i[113] = 78;
            pmeso_grid_i[114] = 35;
            pmeso_grid_i[115] = 7;
            pmeso_grid_i[116] = 9;
            pmeso_grid_i[117] = 17;
            pmeso_grid_i[118] = 12;
            pmeso_grid_i[119] = 19;
            pmeso_grid_i[121] = 2;
            pmeso_grid_i[125] = 5;
            pmeso_grid_i[129] = 2;
            pmeso_grid_i[130] = 2;
            pmeso_grid_i[131] = 5;
            pmeso_grid_i[136] = 4;
            pmeso_grid_i[137] = 6;
            pmeso_grid_i[140] = 2;
            pmeso_grid_i[141] = 3;
            pmeso_grid_i[142] = 6;
            pmeso_grid_i[143] = 8;
        }
        else if(!strcmp(p->res_names[i],"THR"))
{
            pmeso_grid_i[0] = 34;
            pmeso_grid_i[4] = 3;
            pmeso_grid_i[5] = 7;
            pmeso_grid_i[8] = 3;
            pmeso_grid_i[9] = 6;
            pmeso_grid_i[10] = 56;
            pmeso_grid_i[11] = 168;
            pmeso_grid_i[12] = 578;
            pmeso_grid_i[13] = 12;
            pmeso_grid_i[14] = 3;
            pmeso_grid_i[15] = 12;
            pmeso_grid_i[16] = 22;
            pmeso_grid_i[17] = 86;
            pmeso_grid_i[18] = 68;
            pmeso_grid_i[19] = 35;
            pmeso_grid_i[20] = 68;
            pmeso_grid_i[21] = 75;
            pmeso_grid_i[22] = 621;
            pmeso_grid_i[23] = 1714;
            pmeso_grid_i[24] = 517;
            pmeso_grid_i[25] = 33;
            pmeso_grid_i[26] = 72;
            pmeso_grid_i[27] = 124;
            pmeso_grid_i[28] = 424;
            pmeso_grid_i[29] = 2243;
            pmeso_grid_i[30] = 2039;
            pmeso_grid_i[31] = 218;
            pmeso_grid_i[32] = 261;
            pmeso_grid_i[33] = 443;
            pmeso_grid_i[34] = 1277;
            pmeso_grid_i[35] = 2559;
            pmeso_grid_i[36] = 246;
            pmeso_grid_i[37] = 7;
            pmeso_grid_i[38] = 17;
            pmeso_grid_i[39] = 69;
            pmeso_grid_i[40] = 574;
            pmeso_grid_i[41] = 3258;
            pmeso_grid_i[42] = 1568;
            pmeso_grid_i[43] = 67;
            pmeso_grid_i[44] = 115;
            pmeso_grid_i[45] = 440;
            pmeso_grid_i[46] = 1189;
            pmeso_grid_i[47] = 2307;
            pmeso_grid_i[48] = 21;
            pmeso_grid_i[49] = 3;
            pmeso_grid_i[50] = 4;
            pmeso_grid_i[51] = 33;
            pmeso_grid_i[52] = 1509;
            pmeso_grid_i[53] = 1763;
            pmeso_grid_i[54] = 61;
            pmeso_grid_i[55] = 4;
            pmeso_grid_i[56] = 14;
            pmeso_grid_i[57] = 240;
            pmeso_grid_i[58] = 2947;
            pmeso_grid_i[59] = 1243;
            pmeso_grid_i[63] = 12;
            pmeso_grid_i[64] = 57;
            pmeso_grid_i[65] = 4;
            pmeso_grid_i[68] = 2;
            pmeso_grid_i[69] = 8;
            pmeso_grid_i[70] = 49;
            pmeso_grid_i[71] = 3;
            pmeso_grid_i[84] = 2;
            pmeso_grid_i[85] = 4;
            pmeso_grid_i[86] = 9;
            pmeso_grid_i[87] = 3;
            pmeso_grid_i[90] = 2;
            pmeso_grid_i[91] = 25;
            pmeso_grid_i[92] = 17;
            pmeso_grid_i[93] = 2;
            pmeso_grid_i[96] = 4;
            pmeso_grid_i[97] = 7;
            pmeso_grid_i[98] = 5;
            pmeso_grid_i[99] = 10;
            pmeso_grid_i[100] = 19;
            pmeso_grid_i[101] = 22;
            pmeso_grid_i[102] = 40;
            pmeso_grid_i[103] = 51;
            pmeso_grid_i[104] = 19;
            pmeso_grid_i[105] = 13;
            pmeso_grid_i[107] = 18;
            pmeso_grid_i[110] = 3;
            pmeso_grid_i[111] = 5;
            pmeso_grid_i[112] = 10;
            pmeso_grid_i[113] = 31;
            pmeso_grid_i[114] = 16;
            pmeso_grid_i[117] = 7;
            pmeso_grid_i[118] = 9;
            pmeso_grid_i[119] = 17;
            pmeso_grid_i[139] = 2;
            pmeso_grid_i[140] = 2;
            pmeso_grid_i[143] = 2;
        }
        else if(!strcmp(p->res_names[i],"TRP"))
{
            pmeso_grid_i[0] = 4;
            pmeso_grid_i[3] = 2;
            pmeso_grid_i[7] = 3;
            pmeso_grid_i[9] = 5;
            pmeso_grid_i[10] = 26;
            pmeso_grid_i[11] = 79;
            pmeso_grid_i[12] = 48;
            pmeso_grid_i[15] = 9;
            pmeso_grid_i[16] = 12;
            pmeso_grid_i[17] = 22;
            pmeso_grid_i[18] = 22;
            pmeso_grid_i[19] = 14;
            pmeso_grid_i[20] = 47;
            pmeso_grid_i[21] = 44;
            pmeso_grid_i[22] = 185;
            pmeso_grid_i[23] = 233;
            pmeso_grid_i[24] = 18;
            pmeso_grid_i[25] = 9;
            pmeso_grid_i[26] = 8;
            pmeso_grid_i[27] = 17;
            pmeso_grid_i[28] = 63;
            pmeso_grid_i[29] = 179;
            pmeso_grid_i[30] = 293;
            pmeso_grid_i[31] = 53;
            pmeso_grid_i[32] = 93;
            pmeso_grid_i[33] = 95;
            pmeso_grid_i[34] = 298;
            pmeso_grid_i[35] = 164;
            pmeso_grid_i[36] = 13;
            pmeso_grid_i[37] = 5;
            pmeso_grid_i[38] = 2;
            pmeso_grid_i[39] = 17;
            pmeso_grid_i[40] = 118;
            pmeso_grid_i[41] = 567;
            pmeso_grid_i[42] = 344;
            pmeso_grid_i[43] = 31;
            pmeso_grid_i[44] = 143;
            pmeso_grid_i[45] = 166;
            pmeso_grid_i[46] = 380;
            pmeso_grid_i[47] = 157;
            pmeso_grid_i[48] = 2;
            pmeso_grid_i[50] = 2;
            pmeso_grid_i[51] = 13;
            pmeso_grid_i[52] = 588;
            pmeso_grid_i[53] = 667;
            pmeso_grid_i[54] = 12;
            pmeso_grid_i[56] = 5;
            pmeso_grid_i[57] = 54;
            pmeso_grid_i[58] = 1045;
            pmeso_grid_i[59] = 186;
            pmeso_grid_i[63] = 2;
            pmeso_grid_i[64] = 17;
            pmeso_grid_i[65] = 3;
            pmeso_grid_i[69] = 4;
            pmeso_grid_i[70] = 15;
            pmeso_grid_i[85] = 2;
            pmeso_grid_i[91] = 4;
            pmeso_grid_i[92] = 3;
            pmeso_grid_i[97] = 17;
            pmeso_grid_i[98] = 4;
            pmeso_grid_i[99] = 3;
            pmeso_grid_i[100] = 4;
            pmeso_grid_i[101] = 3;
            pmeso_grid_i[102] = 71;
            pmeso_grid_i[103] = 93;
            pmeso_grid_i[104] = 10;
            pmeso_grid_i[107] = 2;
            pmeso_grid_i[111] = 2;
            pmeso_grid_i[112] = 5;
            pmeso_grid_i[113] = 15;
            pmeso_grid_i[114] = 11;
            pmeso_grid_i[115] = 2;
            pmeso_grid_i[118] = 3;
            pmeso_grid_i[125] = 2;
        }
        else if(!strcmp(p->res_names[i],"TYR"))
{
            pmeso_grid_i[0] = 9;
            pmeso_grid_i[4] = 2;
            pmeso_grid_i[9] = 12;
            pmeso_grid_i[10] = 71;
            pmeso_grid_i[11] = 290;
            pmeso_grid_i[12] = 74;
            pmeso_grid_i[13] = 5;
            pmeso_grid_i[14] = 3;
            pmeso_grid_i[15] = 15;
            pmeso_grid_i[16] = 28;
            pmeso_grid_i[17] = 58;
            pmeso_grid_i[18] = 56;
            pmeso_grid_i[19] = 44;
            pmeso_grid_i[20] = 108;
            pmeso_grid_i[21] = 92;
            pmeso_grid_i[22] = 498;
            pmeso_grid_i[23] = 696;
            pmeso_grid_i[24] = 55;
            pmeso_grid_i[25] = 22;
            pmeso_grid_i[26] = 18;
            pmeso_grid_i[27] = 58;
            pmeso_grid_i[28] = 232;
            pmeso_grid_i[29] = 781;
            pmeso_grid_i[30] = 1078;
            pmeso_grid_i[31] = 243;
            pmeso_grid_i[32] = 378;
            pmeso_grid_i[33] = 340;
            pmeso_grid_i[34] = 897;
            pmeso_grid_i[35] = 659;
            pmeso_grid_i[36] = 42;
            pmeso_grid_i[37] = 7;
            pmeso_grid_i[38] = 10;
            pmeso_grid_i[39] = 42;
            pmeso_grid_i[40] = 313;
            pmeso_grid_i[41] = 1040;
            pmeso_grid_i[42] = 1121;
            pmeso_grid_i[43] = 71;
            pmeso_grid_i[44] = 256;
            pmeso_grid_i[45] = 336;
            pmeso_grid_i[46] = 877;
            pmeso_grid_i[47] = 467;
            pmeso_grid_i[50] = 4;
            pmeso_grid_i[51] = 16;
            pmeso_grid_i[52] = 1004;
            pmeso_grid_i[53] = 823;
            pmeso_grid_i[54] = 17;
            pmeso_grid_i[55] = 3;
            pmeso_grid_i[56] = 13;
            pmeso_grid_i[57] = 159;
            pmeso_grid_i[58] = 2071;
            pmeso_grid_i[59] = 402;
            pmeso_grid_i[63] = 11;
            pmeso_grid_i[64] = 28;
            pmeso_grid_i[69] = 11;
            pmeso_grid_i[70] = 42;
            pmeso_grid_i[71] = 2;
            pmeso_grid_i[85] = 2;
            pmeso_grid_i[91] = 30;
            pmeso_grid_i[92] = 16;
            pmeso_grid_i[96] = 11;
            pmeso_grid_i[97] = 31;
            pmeso_grid_i[98] = 12;
            pmeso_grid_i[99] = 8;
            pmeso_grid_i[100] = 24;
            pmeso_grid_i[101] = 25;
            pmeso_grid_i[102] = 273;
            pmeso_grid_i[103] = 374;
            pmeso_grid_i[104] = 31;
            pmeso_grid_i[105] = 2;
            pmeso_grid_i[107] = 6;
            pmeso_grid_i[108] = 2;
            pmeso_grid_i[111] = 4;
            pmeso_grid_i[112] = 10;
            pmeso_grid_i[113] = 28;
            pmeso_grid_i[114] = 27;
            pmeso_grid_i[115] = 2;
            pmeso_grid_i[116] = 5;
            pmeso_grid_i[117] = 2;
            pmeso_grid_i[118] = 2;
            pmeso_grid_i[119] = 3;
            pmeso_grid_i[131] = 2;
        }
        else if(!strcmp(p->res_names[i],"VAL"))
{
            pmeso_grid_i[0] = 3;
            pmeso_grid_i[4] = 4;
            pmeso_grid_i[5] = 2;
            pmeso_grid_i[9] = 3;
            pmeso_grid_i[10] = 26;
            pmeso_grid_i[11] = 28;
            pmeso_grid_i[12] = 55;
            pmeso_grid_i[13] = 4;
            pmeso_grid_i[14] = 2;
            pmeso_grid_i[15] = 5;
            pmeso_grid_i[16] = 23;
            pmeso_grid_i[17] = 29;
            pmeso_grid_i[18] = 38;
            pmeso_grid_i[19] = 21;
            pmeso_grid_i[20] = 47;
            pmeso_grid_i[21] = 134;
            pmeso_grid_i[22] = 715;
            pmeso_grid_i[23] = 807;
            pmeso_grid_i[24] = 110;
            pmeso_grid_i[25] = 14;
            pmeso_grid_i[26] = 10;
            pmeso_grid_i[27] = 109;
            pmeso_grid_i[28] = 596;
            pmeso_grid_i[29] = 1072;
            pmeso_grid_i[30] = 956;
            pmeso_grid_i[31] = 132;
            pmeso_grid_i[32] = 297;
            pmeso_grid_i[33] = 1187;
            pmeso_grid_i[34] = 2710;
            pmeso_grid_i[35] = 1421;
            pmeso_grid_i[36] = 36;
            pmeso_grid_i[37] = 6;
            pmeso_grid_i[38] = 4;
            pmeso_grid_i[39] = 118;
            pmeso_grid_i[40] = 1013;
            pmeso_grid_i[41] = 906;
            pmeso_grid_i[42] = 484;
            pmeso_grid_i[43] = 22;
            pmeso_grid_i[44] = 191;
            pmeso_grid_i[45] = 1374;
            pmeso_grid_i[46] = 2631;
            pmeso_grid_i[47] = 419;
            pmeso_grid_i[48] = 3;
            pmeso_grid_i[51] = 28;
            pmeso_grid_i[52] = 1771;
            pmeso_grid_i[53] = 1345;
            pmeso_grid_i[54] = 19;
            pmeso_grid_i[55] = 7;
            pmeso_grid_i[56] = 6;
            pmeso_grid_i[57] = 347;
            pmeso_grid_i[58] = 3805;
            pmeso_grid_i[59] = 451;
            pmeso_grid_i[63] = 8;
            pmeso_grid_i[64] = 32;
            pmeso_grid_i[68] = 2;
            pmeso_grid_i[69] = 5;
            pmeso_grid_i[70] = 31;
            pmeso_grid_i[85] = 4;
            pmeso_grid_i[91] = 24;
            pmeso_grid_i[92] = 6;
            pmeso_grid_i[93] = 5;
            pmeso_grid_i[97] = 3;
            pmeso_grid_i[98] = 9;
            pmeso_grid_i[99] = 9;
            pmeso_grid_i[100] = 27;
            pmeso_grid_i[101] = 5;
            pmeso_grid_i[102] = 22;
            pmeso_grid_i[103] = 48;
            pmeso_grid_i[104] = 19;
            pmeso_grid_i[105] = 19;
            pmeso_grid_i[106] = 7;
            pmeso_grid_i[111] = 6;
            pmeso_grid_i[112] = 8;
            pmeso_grid_i[115] = 3;
            pmeso_grid_i[117] = 4;
            pmeso_grid_i[118] = 13;
            pmeso_grid_i[136] = 2;
            pmeso_grid_i[142] = 3;
        }
        
        p->pmeso_wt[i] = (double *) pmeso_grid_i;
    
    }
    
    for(i=0;i<p->num_res-1;i++)
    {
        int denom =0;
        double denom1;
        double prob[144];
        fprintf(file,"%s\n",p->res_names[i]);
        for(j=0;j<144;j++)
        {
            denom += p->pmeso_wt[i][j];
        }
        if(denom >0) denom1 = 1.0/(double) denom;
        else denom1 = 0.0;
        for(k=0;k<144;k++)
        {
            prob[k] = (double) p->pmeso_wt[i][k] * denom;
            fprintf(file,"%12.4e\n",prob[k]);
        }
        
        
    }
    

}

